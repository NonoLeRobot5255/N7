%Generate the data for the TP
%(ie a Distance matrix between european capitals)

clear
addpath('matlab_bgl');      %load graph libraries

cities={'Amsterdam'	'Andorra' 'Ankara'	'Athens'	'Berlin'	'Bern'	'Brussels'	...
        'Copenhagen'	'Dublin'	'Helsinki'	'Kiev'	'Lisbon'	'London' ...
        'Madrid'	'Minsk'	'Moscow'	'Oslo'	'Paris'	'Prague'	'Reykjavík'	'Rome' ...
        'Sofia'	'Stockholm'	'Vienna'	'Warsaw' 'Zagreb' 'Torshavn'};

D=[
   0	1126	2536	2163	 578	 630	 175	 624	 755	1502	1782	1864	 355	1481	1512	2149	 913	 430	 710	1761	1300	1744	1126	 936	1095 1087 1273
1126	   0	2622	1945	1426	 681	 951	1672	1335	2524	2372	 993	1011	 493	2283	2965	2036	 710	1300	2646	 907	1779	2189	1320	1817 1208 2020
2536	2622	   0	 817	2037	2184	2513	2302	3283	2317	1183	3582	2832	3085	1600	1794	2700	2598	1829	4096	1720	 854	2394	1602	1643 1519 3771
2163	1945	 817	   0	1802	1661	2088	2140	2853	2467	1484	2853	2390	2371	1786	2230	2604	2096	1535	3881	1049	 523	2407	1283	1600 1078 3437
 578	1426	2037	1802	   0	 754	 653	 359	1318	1104	1204	2315	 931	1871	 948	1608	 837	 880	 279	2093	1187	1319	 809	 523	 516  771 1694
 630	 681	2184	1661	 754	   0	 487	1038	1203	1858	1731	1628	 746	1152	1608	2290	1458	 435	 622	2374	 692	1336	1545	 684	1141  667 1837
 175	 951	2513	2088	 653	 487	   0	 770	 775	1650	1837	1712	 320	1315	1601	2255	1087	 262	 718	1886	1174	1697	1282	 914	1161 1024 1358
 624	1672	2302	2140	 359	1038	 770	   0	1239	 880	1330	2482	 956	2077	 978	1560	 478	1031	 637	1795	1539	1642	 518	 874	 673 1129 1473
 755	1335	3283	2853	1318	1203	 775	1239	   0	2025	2516	1640	 463	1449	2208	2796	1266	 778	1464	1322	1887	2473	1630	1681	1827 1798  688
1502	2524	2317	2467	1104	1858	1650	 880	2025	   0	1137	3362	1819	2949	 720	 893	 787	1909	1301	2087	2204	1947	 396	1439	 912 1704 2009
1782	2372	1183	1484	1204	1731	1837	1330	2516	1137	   0	3353	2132	2863	 432	 757	1628	2025	1142	3046	1676	1022	1266	1053	 690 1195 2800
1864	 993	3582	2853	2315	1628	1712	2482	1640	3362	3353	   0	1588	 502	3229	3907	2739	1453	2245	2876	1864	2754	2990	2300	2762 2201 2208
 355	1011	2832	2390	 931	 746	 320	 956	 463	1819	2132	1588	   0	1265	1867	2499	1152	 343	1032	1675	1436	2014	1431	1233	1447 1337 1088
1481	 493	3085	2371	1871	1152	1315	2077	1449	2949	2863	 502	1265	   0	2760	3442	2388	1053	1774	2766	1365	2253	2594	1811	2293 1701 2093
1512	2283	1600	1786	 948	1608	1601	 978	2208	 720	 432	3229	1867	2760	   0	 682	1216	1822	 986	2638	1732	1279	 838	 997	 468 1216 2416
2149	2965	1794	2230	1608	2290	2255	1560	2796	 893	 757	3907	2499	3442	 682	   0	1644	2488	1667	2586	2378	1779	1228	1670	1149 1870 2881
 913	2036	2700	2604	 837	1458	1087	 478	1266	 787	1628	2739	1152	2388	1216	1644	   0	1342	1116	1427	2009	2097	 417	1350	1061 1607 1240
 430	 710	2598	2096	 880	 435	 262	1031	 778	1909	2025	1453	 343	1053	1822	2488	1342	   0	 884	2019	1109	1758	1544	1034	1369 1081 1443
 710	1300	1829	1535	 279	 622	 718	 637	1464	1301	1142	2245	1032	1774	 986	1667	1116	 884	  0	    2348	 926	1068	1053	 252	 518  492 1951
1761	2646    4096	3881	2093	2374	1886	1795	1322	2087	3046	2876	1675	2766	2638	2586	1427	2019	2348	   0	3053	3416	1807	2597	2459 2808  657
1300	 907	1720	1049	1187	 692	1174	1539	1887	2204	1676	1864	1436	1365	1732	2378	2009	1109	 926	3053	   0	 893	1979	 768	1321  517 2526
1744	1779	 854	 523	1319	1336	1697	1642	2473	1947	1022	2754	2014	2253	1279	1779	2097	1758	1068	3416	 893	   0	1885	 819	1078  679 2960
1126	2189	2394	2407	 809	1545	1282	 518	1630	 396	1266	2990	1431	2594	 838	1228	 417	1544	1053	1807	1979	1885	   0	1241	 808 1511 1658
 936	1320	1602	1283	 523	 684	 914	 874	1681	1439	1053	2300	1233	1811	 997	1670	1350	1034	 252	2597	 768	 819	1241       0	 558  271 2191
1095	1817	1643	1600	 516	1141	1161	 673	1827	 912	690	    2762	1447	2293	 468	1149	1061	1369	 518	2459    1321	1078     808	 558	   0  807 2139
1087	1208	1519	1078	 771	 667	1024    1129	1798	1704	1195	2201	1337	1701	1216	1870	1607	1081	 492	2808	 517	 679	1511     271     807    0 2305	
1273    2020    3771    3437    1694    1837    1358    1473     688    2009    2800    2208    1088    2093    2416    2881    1240    1443    1951     657    2526    2960    1658    2191    2139 2305    0
];


             
%Choose pos=(X,Y) positions for cities
Y = cmdscale(D); %relative position from distance
pos=Y(:,1:2);
%pos=kamada_kawai_spring_layout(sparse(D));
%theta=0.95;
theta=2.8;%rotation of the map to align it with north
x = pos(:,1)*cos(theta) + pos(:,2)*sin(theta);
y = -pos(:,1)*sin(theta) + pos(:,2)*cos(theta); 
%pos(:,1)=x;
%pos(:,2)=-y;
pos(:,1)=x;
pos(:,2)=-y; %horizontal flip
save TPgraphe.mat; 